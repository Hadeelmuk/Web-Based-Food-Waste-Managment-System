module.exports=[65977,a=>{"use strict";var b=a.i(76681),c=a.i(26711),d=a.i(2471),e=a.i(71594),f=a.i(20923),g=a.i(88848),h=a.i(18443);let i=(0,g.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function j({className:a,variant:c,asChild:d=!1,...e}){let g=d?f.Slot:"span";return(0,b.jsx)(g,{"data-slot":"badge",className:(0,h.cn)(i({variant:c}),a),...e})}var k=a.i(23098),l=a.i(47462),m=a.i(52336),n=a.i(71709),o=a.i(98110),p=a.i(58273);function q({value:a,onChange:c,className:d}){let[e,f]=(a||"12:00").split(":").map(Number),g=e||12,[i,j]=p.useState(g>12?g-12:0===g?12:g),[k,l]=p.useState(f||0),[m,n]=p.useState(g>=12?"PM":"AM"),o=p.useRef(null),q=p.useRef(null),r=p.useRef(null),s=Array.from({length:12},(a,b)=>b+1),t=Array.from({length:60},(a,b)=>b),u=p.useRef(!1),v=p.useRef(""),w=p.useRef(c);p.useEffect(()=>{w.current=c},[c]),p.useEffect(()=>{if(u.current){u.current=!1;return}let a=i;"PM"===m&&12!==i?a=i+12:"AM"===m&&12===i&&(a=0);let b=`${String(a).padStart(2,"0")}:${String(k).padStart(2,"0")}`;b!==v.current&&(v.current=b,w.current(b))},[i,k,m]),p.useEffect(()=>{let b=a||"12:00";if(b===v.current)return;let[c,d]=b.split(":").map(Number),e=c||12,f=e>12?e-12:0===e?12:e,g=e>=12?"PM":"AM";(i!==f||k!==(d||0)||m!==g)&&(u.current=!0,v.current=b,j(f),l(d||0),n(g))},[a,i,k,m]),p.useEffect(()=>{if(o.current){let a=s.indexOf(i);a>=0&&(o.current.scrollTop=40*a)}},[i,s]),p.useEffect(()=>{q.current&&(q.current.scrollTop=40*k)},[k]),p.useEffect(()=>{if(r.current){let a=+("AM"!==m);r.current.scrollTop=40*a}},[m]);let x=(a,b)=>{if(!b.current)return;let c=Math.round(b.current.scrollTop/40);if("hour"===a)j(s[c]||s[0]),b.current.scrollTo({top:40*c,behavior:"smooth"});else if("minute"===a){let a=Math.max(0,Math.min(59,c));l(a),b.current.scrollTo({top:40*a,behavior:"smooth"})}else n(0===c?"AM":"PM"),b.current.scrollTo({top:40*c,behavior:"smooth"})},y=(a,b,c)=>{if("hour"===a){j(b);let a=s.indexOf(b);c.current&&a>=0&&c.current.scrollTo({top:40*a,behavior:"smooth"})}else if("minute"===a)l(b),c.current&&c.current.scrollTo({top:40*b,behavior:"smooth"});else{n(b);let a=+("AM"!==b);c.current&&c.current.scrollTo({top:40*a,behavior:"smooth"})}};return(0,b.jsxs)("div",{className:(0,h.cn)("flex items-center gap-1 bg-muted/30 rounded-lg p-3 border",d),children:[(0,b.jsxs)("div",{className:"flex-1 relative h-40 overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 h-10 border-t-2 border-b-2 border-primary/30 pointer-events-none z-10"}),(0,b.jsx)("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 h-10 bg-primary/5 pointer-events-none z-0"}),(0,b.jsx)("div",{ref:o,className:"h-full overflow-y-scroll scroll-smooth snap-y snap-mandatory hide-scrollbar",onScroll:()=>x("hour",o),style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:(0,b.jsx)("div",{className:"py-16",children:s.map(a=>(0,b.jsx)("div",{className:(0,h.cn)("h-10 flex items-center justify-center text-lg font-medium cursor-pointer transition-all snap-center",i===a?"text-primary font-bold scale-110":"text-muted-foreground hover:text-foreground"),onClick:()=>y("hour",a,o),children:String(a).padStart(2,"0")},a))})})]}),(0,b.jsx)("div",{className:"text-2xl font-bold text-muted-foreground px-1",children:":"}),(0,b.jsxs)("div",{className:"flex-1 relative h-40 overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 h-10 border-t-2 border-b-2 border-primary/30 pointer-events-none z-10"}),(0,b.jsx)("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 h-10 bg-primary/5 pointer-events-none z-0"}),(0,b.jsx)("div",{ref:q,className:"h-full overflow-y-scroll scroll-smooth snap-y snap-mandatory hide-scrollbar",onScroll:()=>x("minute",q),style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:(0,b.jsx)("div",{className:"py-16",children:t.map(a=>(0,b.jsx)("div",{className:(0,h.cn)("h-10 flex items-center justify-center text-lg font-medium cursor-pointer transition-all snap-center",k===a?"text-primary font-bold scale-110":"text-muted-foreground hover:text-foreground"),onClick:()=>y("minute",a,q),children:String(a).padStart(2,"0")},a))})})]}),(0,b.jsxs)("div",{className:"flex-1 relative h-40 overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 h-10 border-t-2 border-b-2 border-primary/30 pointer-events-none z-10"}),(0,b.jsx)("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 h-10 bg-primary/5 pointer-events-none z-0"}),(0,b.jsx)("div",{ref:r,className:"h-full overflow-y-scroll scroll-smooth snap-y snap-mandatory hide-scrollbar",onScroll:()=>x("ampm",r),style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:(0,b.jsx)("div",{className:"py-16",children:["AM","PM"].map(a=>(0,b.jsx)("div",{className:(0,h.cn)("h-10 flex items-center justify-center text-lg font-medium cursor-pointer transition-all snap-center",m===a?"text-primary font-bold scale-110":"text-muted-foreground hover:text-foreground"),onClick:()=>y("ampm",a,r),children:a},a))})})]})]})}var r=a.i(42805),s=a.i(40615),t=a.i(32269);let u=(0,t.default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var v=a.i(15751);let w=(0,t.default)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),x=(0,t.default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var y=a.i(14836);let z=(0,t.default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var A=a.i(36520),B=a.i(23474),C=a.i(25327);let D=(0,B.withAuth)(function(){let[a,f]=(0,p.useState)([]),[g,h]=(0,p.useState)([]),[i,t]=(0,p.useState)(!0),[B,D]=(0,p.useState)(!1),[E,F]=(0,p.useState)(!1),[G,H]=(0,p.useState)(!1),[I,J]=(0,p.useState)(null),[K,L]=(0,p.useState)("SCHEDULED"),[M,N]=(0,p.useState)(""),[O,P]=(0,p.useState)(!1),[Q,R]=(0,p.useState)({requesterId:"",wasteType:"",quantity:"",requesterName:"",pickupMethod:"staff",assignedTo:"",pickupDate:"",pickupWindowFrom:"",pickupWindowTo:"",status:"scheduled",notes:""}),S=a.filter(a=>{let b=a.status.toLowerCase();return"scheduled"===b||"pickup-scheduled"===b||"completed"===b||"in-transit"===b||"in_transit"===b||"cancelled"===b}),T=S.filter(a=>{let b=a.status.toLowerCase();return"scheduled"===b||"pickup-scheduled"===b}).length,U=S.filter(a=>{let b=a.status.toLowerCase();return"in-transit"===b||"in_transit"===b||"in transit"===b}).length,V=S.filter(a=>{let b=a.status.toLowerCase();return"completed"===b||"delivered"===b}).length,W=S.reduce((a,b)=>a+(b.quantity||b.pickupRequest?.quantity||0),0);(0,p.useEffect)(()=>{X()},[]);let X=async()=>{try{let a=JSON.parse(localStorage.getItem("user")||"{}");if(!a.userId)return;let b=await fetch("/api/admin/transportations",{headers:{"x-user-id":a.userId}});if(b.ok){let a=((await b.json()).transportations||[]).map(a=>{let b=a.wasteType||a.itemName||"Unknown",c=a.quantity||0,d=a.requesterName||a.destination||"Unknown",e=a.requesterName||d,f=(a.pickupRequestId||a.id).substring(0,6).toUpperCase(),g=`${e}-${f}`;return{id:a.id,pickupRequestId:a.pickupRequestId||"",wasteEntryId:a.wasteEntryId||"",transportType:a.pickupRequestId?"internal":"external",assignedTo:a.driverName||void 0,pickupDate:a.scheduledDate||"",pickupWindow:{from:a.scheduledTime?.split("-")[0]||"",to:a.scheduledTime?.split("-")[1]||""},notes:a.notes||void 0,status:a.status||"SCHEDULED",destination:d,quantity:c,wasteType:b,requesterId:a.pickupRequestId||a.id,formattedRequesterId:g,businessName:e,pickupRequest:{itemName:a.itemName||b,quantity:c,requesterName:e}}});f(a)}}catch(a){console.error("Error fetching transports:",a)}finally{t(!1)}},Y=async()=>{D(!0);try{let a=JSON.parse(localStorage.getItem("user")||"{}");if(!a.userId)return;let b=await fetch("/api/admin/pickups/approved",{headers:{"x-user-id":a.userId}});if(b.ok){let a=await b.json();h(a.approvedPickups||[])}}catch(a){console.error("Error fetching approved pickups:",a)}finally{D(!1)}},Z=async()=>{if(!M&&!O)return void C.toast.error("Please select an approved pickup request");if(!Q.pickupDate||!Q.pickupWindowFrom||!Q.pickupWindowTo)return void C.toast.error("Please fill in date and time fields");if(!Q.assignedTo)return void C.toast.error("Please enter driver/staff name");try{let a=JSON.parse(localStorage.getItem("user")||"{}");if(!a.userId)return void C.toast.error("Please log in again");let b=`${Q.pickupWindowFrom}-${Q.pickupWindowTo}`,c=[`Driver: ${Q.assignedTo}`,`Pickup Method: ${"staff"===Q.pickupMethod?"Café staff":"External courier (Grab / Lalamove)"}`,Q.notes].filter(Boolean).join("\n"),d=await fetch("/api/admin/transportations",{method:"POST",headers:{"Content-Type":"application/json","x-user-id":a.userId},body:JSON.stringify({pickupRequestId:"admin-override"===M?Q.requesterId:M,scheduledDate:Q.pickupDate,scheduledTime:b,driverName:Q.assignedTo,notes:c,isAdminOverride:O,manualDestination:O?Q.requesterName:void 0,manualQuantity:O?parseFloat(Q.quantity):void 0,manualWasteType:O?Q.wasteType:void 0})});if(d.ok)C.toast.success("Transportation scheduled successfully"),F(!1),R({requesterId:"",wasteType:"",quantity:"",requesterName:"",pickupMethod:"staff",assignedTo:"",pickupDate:"",pickupWindowFrom:"",pickupWindowTo:"",status:"scheduled",notes:""}),N(""),P(!1),X();else{let a=await d.json();C.toast.error(a.error||"Failed to schedule transportation")}}catch(a){console.error("Error scheduling pickup:",a),C.toast.error("An error occurred. Please try again.")}},$=async(a,b)=>{try{let b=JSON.parse(localStorage.getItem("user")||"{}");if(!b.userId)return void C.toast.error("User not found. Please log in again");let c=await fetch(`/api/admin/transportations/${a}/complete`,{method:"PATCH",headers:{"Content-Type":"application/json","x-user-id":b.userId}});if(c.ok){let a=await c.json();C.toast.success(`Completed! ${a.data?.pointsAwarded||0} points awarded`),X()}else{let a=await c.json();C.toast.error(a.error||"Failed to mark as completed")}}catch(a){console.error("Error marking as completed:",a),C.toast.error("An error occurred. Please try again.")}},_=async a=>{if(confirm("Are you sure you want to delete this transportation record? This action cannot be undone."))try{let b=JSON.parse(localStorage.getItem("user")||"{}");if(!b.userId)return void C.toast.error("User not found. Please log in again");let c=await fetch(`/api/transportation/${a}`,{method:"DELETE",headers:{"x-user-id":b.userId}});if(c.ok)C.toast.success("Transportation record deleted successfully"),X();else{let a=await c.json();C.toast.error(a.error||"Failed to delete transportation record")}}catch(a){console.error("Error deleting transportation record:",a),C.toast.error("An error occurred. Please try again.")}},aa=async()=>{if(I)try{let a=JSON.parse(localStorage.getItem("user")||"{}");if(!a.userId)return void C.toast.error("User not found. Please log in again");if("COMPLETED"===K){let b=await fetch(`/api/admin/transportations/${I.id}/complete`,{method:"PATCH",headers:{"Content-Type":"application/json","x-user-id":a.userId}});if(b.ok){let a=await b.json();C.toast.success(`Completed! ${a.data?.pointsAwarded||0} points awarded`),H(!1),J(null),X()}else{let a=await b.json();C.toast.error(a.error||"Failed to complete")}return}let b=await fetch(`/api/transportation/${I.id}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-user-id":a.userId},body:JSON.stringify({status:K})});if(b.ok)C.toast.success("Status updated successfully"),H(!1),J(null),X();else{let a=await b.json();C.toast.error(a.error||"Failed to update status")}}catch(a){console.error("Error updating status:",a),C.toast.error("An error occurred. Please try again.")}};return(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsx)(c.DashboardNav,{}),(0,b.jsx)("main",{className:"pt-20 px-4 pb-8",children:(0,b.jsxs)("div",{className:"container mx-auto max-w-7xl",children:[(0,b.jsxs)("div",{className:"mb-6 flex items-start gap-3",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center flex-shrink-0",children:(0,b.jsx)(s.Truck,{className:"w-6 h-6 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"font-display font-bold text-3xl text-foreground mb-1",children:"Transportation Organizer"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage food waste pickups and deliveries"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,b.jsxs)(d.Card,{className:"p-6 hover:shadow-lg transition-shadow bg-gradient-to-br from-yellow-50 to-background border-2 border-yellow-500/20",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,b.jsx)("div",{className:"w-12 h-12 rounded-xl bg-yellow-500/10 flex items-center justify-center",children:(0,b.jsx)(r.Clock,{className:"w-6 h-6 text-yellow-600"})})}),(0,b.jsx)("div",{className:"text-3xl font-display font-bold text-foreground mb-1",children:T}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground font-medium",children:"Scheduled Pickups"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:"Upcoming waste collections"})]}),(0,b.jsxs)(d.Card,{className:"p-6 hover:shadow-lg transition-shadow bg-gradient-to-br from-blue-50 to-background border-2 border-blue-500/20",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,b.jsx)("div",{className:"w-12 h-12 rounded-xl bg-blue-500/10 flex items-center justify-center",children:(0,b.jsx)(s.Truck,{className:"w-6 h-6 text-blue-600"})})}),(0,b.jsx)("div",{className:"text-3xl font-display font-bold text-foreground mb-1",children:U}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground font-medium",children:"In Transit"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:"Active deliveries in progress"})]}),(0,b.jsxs)(d.Card,{className:"p-6 hover:shadow-lg transition-shadow bg-gradient-to-br from-green-50 to-background border-2 border-primary/20",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,b.jsx)("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center",children:(0,b.jsx)(u,{className:"w-6 h-6 text-primary"})})}),(0,b.jsx)("div",{className:"text-3xl font-display font-bold text-foreground mb-1",children:V}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground font-medium",children:"Completed Deliveries"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:"Total finished transports"})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-3 mb-6",children:[(0,b.jsxs)(e.Button,{className:"bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>{Y(),F(!0)},children:[(0,b.jsx)(s.Truck,{className:"w-4 h-4 mr-2"}),"Schedule Transportation"]}),(0,b.jsx)(e.Button,{variant:"outline",className:"border-primary/20 hover:bg-primary/5 bg-transparent",children:"Update Status"})]}),(0,b.jsx)("div",{className:"mb-8",children:(0,b.jsxs)(d.Card,{className:"p-6 bg-card",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)("h3",{className:"font-display font-bold text-xl text-foreground",children:"Transport Requests"}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>{if(0===S.length)return void C.toast.error("No data to export");let a=new Blob([["Requester ID,Café,Destination,Type,Quantity (kg),Status,Pickup Date,Pickup Time,Assigned To",...S.map(a=>{let b=a.destination||a.pickupRequest?.requesterName||"Unknown",c=a.wasteType||a.pickupRequest?.itemName||"Unknown",d=a.quantity||a.pickupRequest?.quantity||0,e=a.pickupDate?new Date(a.pickupDate).toLocaleDateString():"",f=a.pickupWindow?.from&&a.pickupWindow?.to?`${a.pickupWindow.from} - ${a.pickupWindow.to}`:"",g=a.assignedTo||"";return[`"${a.formattedRequesterId||a.businessName?`${a.businessName}-${(a.requesterId||a.id).substring(0,6).toUpperCase()}`:a.requesterId||a.id}"`,`"Green Caf\xe9"`,`"${b}"`,`"${c}"`,d,`"${a.status}"`,`"${e}"`,`"${f}"`,`"${g}"`].join(",")})].join("\n")],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a"),c=URL.createObjectURL(a);b.setAttribute("href",c),b.setAttribute("download",`transportation-records-${new Date().toISOString().split("T")[0]}.csv`),b.style.visibility="hidden",document.body.appendChild(b),b.click(),document.body.removeChild(b),C.toast.success("Transportation records exported successfully")},children:"Export"})]}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-border bg-muted/50",children:[(0,b.jsx)("th",{className:"text-left py-3 px-4 font-display font-semibold text-sm text-muted-foreground",children:"Requester ID"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-display font-semibold text-sm text-muted-foreground",children:"Café"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-display font-semibold text-sm text-muted-foreground",children:"Destination"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-display font-semibold text-sm text-muted-foreground",children:"Type"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-display font-semibold text-sm text-muted-foreground",children:"Quantity"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-display font-semibold text-sm text-muted-foreground",children:"Status"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-display font-semibold text-sm text-muted-foreground",children:"Action"})]})}),(0,b.jsx)("tbody",{children:S.map(a=>{let c,d,f=a.destination||a.pickupRequest?.requesterName||"Unknown",g=a.wasteType||a.pickupRequest?.itemName||"Unknown",h=a.quantity||a.pickupRequest?.quantity||0;return(0,b.jsxs)("tr",{className:"border-b border-border hover:bg-accent/5 transition-colors",children:[(0,b.jsx)("td",{className:"py-4 px-4 font-medium text-foreground",children:a.formattedRequesterId||a.businessName?`${a.businessName}-${(a.requesterId||a.id).substring(0,6).toUpperCase()}`:a.requesterId||a.id}),(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:(0,b.jsx)(w,{className:"w-4 h-4 text-primary"})}),(0,b.jsx)("span",{className:"text-foreground",children:"Green Café"})]})}),(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(v.MapPin,{className:"w-4 h-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-foreground",children:f})]})}),(0,b.jsx)("td",{className:"py-4 px-4 text-muted-foreground",children:g}),(0,b.jsxs)("td",{className:"py-4 px-4 font-medium text-foreground",children:[h," kg"]}),(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsx)(j,{variant:"outline",className:"scheduled"===(c=a.status.toLowerCase())||"pickup-scheduled"===c?"bg-yellow-500/10 text-yellow-600 border-yellow-500/20":"in-transit"===c||"in_transit"===c||"in transit"===c?"bg-blue-500/10 text-blue-600 border-blue-500/20":"completed"===c||"delivered"===c?"bg-primary/10 text-primary border-primary/20":"cancelled"===c?"bg-red-500/10 text-red-600 border-red-500/20":"bg-muted text-muted-foreground",children:(0,b.jsxs)("span",{className:"flex items-center gap-1.5",children:["scheduled"===(d=a.status.toLowerCase())||"pickup-scheduled"===d?(0,b.jsx)(r.Clock,{className:"w-4 h-4"}):"in-transit"===d||"in_transit"===d||"in transit"===d?(0,b.jsx)(s.Truck,{className:"w-4 h-4"}):"completed"===d||"delivered"===d?(0,b.jsx)(u,{className:"w-4 h-4"}):null,a.status]})})}),(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:["pickup-scheduled"===a.status||"scheduled"===a.status||"Scheduled"===a.status?(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:()=>$(a.id,a.pickupRequestId),className:"hover:bg-green-500/10 hover:text-green-600",children:[(0,b.jsx)(u,{className:"w-4 h-4 mr-1"}),"Mark as Completed"]}):(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",className:"hover:bg-primary/10 hover:text-primary",children:[(0,b.jsx)(x,{className:"w-4 h-4 mr-1"}),"View"]}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>(J(a),void(L({SCHEDULED:"SCHEDULED",scheduled:"SCHEDULED",Scheduled:"SCHEDULED",IN_TRANSIT:"IN_TRANSIT","in-transit":"IN_TRANSIT","In Transit":"IN_TRANSIT",COMPLETED:"COMPLETED",completed:"COMPLETED",Completed:"COMPLETED",delivered:"COMPLETED",CANCELLED:"CANCELLED",cancelled:"CANCELLED"}[a.status]||"SCHEDULED"),H(!0))),className:"hover:bg-blue-500/10 hover:text-blue-600",children:(0,b.jsx)(z,{className:"w-4 h-4"})}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>_(a.id),className:"hover:bg-red-500/10 hover:text-red-600",children:(0,b.jsx)(y.Trash2,{className:"w-4 h-4"})})]})})]},a.id)})})]})})]})}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,b.jsxs)(d.Card,{className:"p-6 bg-card border-2 border-border hover:border-primary/20 transition-colors",children:[(0,b.jsx)("div",{className:"text-2xl font-display font-bold text-foreground mb-1",children:"48.5 km"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Distance Today"})]}),(0,b.jsxs)(d.Card,{className:"p-6 bg-card border-2 border-border hover:border-primary/20 transition-colors",children:[(0,b.jsxs)("div",{className:"text-2xl font-display font-bold text-foreground mb-1",children:[W.toFixed(1)," kg"]}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Waste Transported"})]}),(0,b.jsxs)(d.Card,{className:"p-6 bg-card border-2 border-border hover:border-primary/20 transition-colors",children:[(0,b.jsx)("div",{className:"text-2xl font-display font-bold text-foreground mb-1",children:"8"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Active Partners"})]}),(0,b.jsxs)(d.Card,{className:"p-6 bg-card border-2 border-border hover:border-primary/20 transition-colors",children:[(0,b.jsx)("div",{className:"text-2xl font-display font-bold text-foreground mb-1",children:"98%"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"On-Time Delivery Rate"})]})]})]})}),(0,b.jsx)(k.Dialog,{open:E,onOpenChange:F,children:(0,b.jsxs)(k.DialogContent,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsx)(k.DialogTitle,{children:"Schedule Transportation"}),(0,b.jsx)(k.DialogDescription,{children:"Select an approved pickup request and schedule transportation"})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[!B&&0===g.length&&(0,b.jsxs)("div",{className:"flex items-start gap-3 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,b.jsx)(A.AlertTriangle,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-yellow-800",children:"No Approved Pickups"}),(0,b.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"There are no approved pickup requests available. You can still create transportation manually using Admin Override below."})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:"pickupSelect",children:"Select Approved Pickup Request *"}),(0,b.jsxs)(o.Select,{value:M,onValueChange:a=>{if(N(a),"admin-override"===a){P(!0),R(a=>({...a,requesterId:"",wasteType:"",quantity:"",requesterName:""}));return}P(!1);let b=g.find(b=>b.id===a);b&&R(a=>({...a,requesterId:b.id,wasteType:b.wasteType||b.itemName,quantity:String(b.quantity),requesterName:b.requesterName}))},disabled:B,children:[(0,b.jsx)(o.SelectTrigger,{id:"pickupSelect",children:(0,b.jsx)(o.SelectValue,{placeholder:B?"Loading...":"Select a pickup request"})}),(0,b.jsxs)(o.SelectContent,{children:[g.map(a=>(0,b.jsx)(o.SelectItem,{value:a.id,children:(0,b.jsxs)("span",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-medium",children:a.requesterName}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[a.quantity," kg ",a.wasteType," • ","charity"===a.requesterType?"Charity":"Farmer"]})]})},a.id)),(0,b.jsx)(o.SelectItem,{value:"admin-override",className:"border-t mt-2 pt-2",children:(0,b.jsxs)("span",{className:"flex items-center gap-2 text-yellow-600",children:[(0,b.jsx)(A.AlertTriangle,{className:"w-4 h-4"}),"Admin Override (Manual Entry)"]})})]})]})]}),M&&"admin-override"!==M&&(0,b.jsx)(d.Card,{className:"p-4 bg-muted/50",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Requester:"}),(0,b.jsx)("p",{className:"font-medium",children:Q.requesterName})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Type:"}),(0,b.jsx)("p",{className:"font-medium",children:Q.wasteType})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Quantity:"}),(0,b.jsxs)("p",{className:"font-medium",children:[Q.quantity," kg"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Request ID:"}),(0,b.jsx)("p",{className:"font-medium text-xs",children:M})]})]})}),O&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,b.jsx)("p",{className:"text-sm text-yellow-700",children:"⚠️ Admin Override Mode: Enter pickup details manually"})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:"requesterId",children:"Pickup Request ID *"}),(0,b.jsx)(l.Input,{id:"requesterId",placeholder:"Enter pickup request ID",value:Q.requesterId,onChange:a=>R({...Q,requesterId:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:"wasteType",children:"Waste Type *"}),(0,b.jsx)(l.Input,{id:"wasteType",placeholder:"e.g., Coffee Grounds",value:Q.wasteType,onChange:a=>R({...Q,wasteType:a.target.value}),required:!0})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:"quantity",children:"Quantity (kg) *"}),(0,b.jsx)(l.Input,{id:"quantity",type:"number",step:"0.1",min:"0",placeholder:"e.g., 15.5",value:Q.quantity,onChange:a=>R({...Q,quantity:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:"requesterName",children:"Requester Name *"}),(0,b.jsx)(l.Input,{id:"requesterName",placeholder:"e.g., Hope Charity",value:Q.requesterName,onChange:a=>R({...Q,requesterName:a.target.value}),required:!0})]})]})]}),(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Transportation Schedule"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:"pickupMethod",children:"Pickup Method *"}),(0,b.jsxs)(o.Select,{value:Q.pickupMethod,onValueChange:a=>R({...Q,pickupMethod:a}),children:[(0,b.jsx)(o.SelectTrigger,{id:"pickupMethod",children:(0,b.jsx)(o.SelectValue,{})}),(0,b.jsxs)(o.SelectContent,{children:[(0,b.jsx)(o.SelectItem,{value:"staff",children:"Café staff"}),(0,b.jsx)(o.SelectItem,{value:"courier",children:"External courier (Grab / Lalamove)"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2 mt-4",children:[(0,b.jsx)(m.Label,{htmlFor:"assignedTo",children:"Driver / Staff Name *"}),(0,b.jsx)(l.Input,{id:"assignedTo",placeholder:"staff"===Q.pickupMethod?"Staff member name":"Courier name",value:Q.assignedTo,onChange:a=>R({...Q,assignedTo:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2 mt-4",children:[(0,b.jsx)(m.Label,{htmlFor:"pickupDate",children:"Pickup Date *"}),(0,b.jsx)(l.Input,{id:"pickupDate",type:"date",value:Q.pickupDate,onChange:a=>R({...Q,pickupDate:a.target.value}),min:new Date().toISOString().split("T")[0],required:!0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{children:"Pickup Time From *"}),(0,b.jsx)(q,{value:Q.pickupWindowFrom||"12:00",onChange:a=>R({...Q,pickupWindowFrom:a})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{children:"Pickup Time To *"}),(0,b.jsx)(q,{value:Q.pickupWindowTo||"12:00",onChange:a=>R({...Q,pickupWindowTo:a})})]})]}),(0,b.jsxs)("div",{className:"space-y-2 mt-4",children:[(0,b.jsx)(m.Label,{htmlFor:"notes",children:"Notes (Optional)"}),(0,b.jsx)(n.Textarea,{id:"notes",placeholder:"Additional notes or instructions...",value:Q.notes,onChange:a=>R({...Q,notes:a.target.value}),rows:2})]})]})]}),(0,b.jsxs)(k.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>{R({requesterId:"",wasteType:"",quantity:"",requesterName:"",pickupMethod:"staff",assignedTo:"",pickupDate:"",pickupWindowFrom:"",pickupWindowTo:"",status:"scheduled",notes:""}),N(""),P(!1),F(!1)},children:"Cancel"}),(0,b.jsxs)(e.Button,{onClick:Z,className:"bg-primary hover:bg-primary/90",disabled:!M&&!O,children:[(0,b.jsx)(s.Truck,{className:"w-4 h-4 mr-2"}),"Schedule Transportation"]})]})]})}),(0,b.jsx)(k.Dialog,{open:G,onOpenChange:H,children:(0,b.jsxs)(k.DialogContent,{className:"sm:max-w-[400px]",children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsx)(k.DialogTitle,{children:"Update Status"}),(0,b.jsx)(k.DialogDescription,{children:"Update the status of this transportation record"})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:"editStatus",children:"Status *"}),(0,b.jsxs)(o.Select,{value:K,onValueChange:a=>L(a),children:[(0,b.jsx)(o.SelectTrigger,{id:"editStatus",children:(0,b.jsx)(o.SelectValue,{})}),(0,b.jsxs)(o.SelectContent,{children:[(0,b.jsx)(o.SelectItem,{value:"SCHEDULED",children:"Scheduled"}),(0,b.jsx)(o.SelectItem,{value:"IN_TRANSIT",children:"In Transit"}),(0,b.jsx)(o.SelectItem,{value:"COMPLETED",children:"Completed"}),(0,b.jsx)(o.SelectItem,{value:"CANCELLED",children:"Cancelled"})]})]})]}),I&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Requester ID:"})," ",I.formattedRequesterId||I.businessName?`${I.businessName}-${(I.requesterId||I.id).substring(0,6).toUpperCase()}`:I.requesterId||I.id]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Destination:"})," ",I.destination||"Unknown"]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Current Status:"})," ",I.status]})]})]}),(0,b.jsxs)(k.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>{H(!1),J(null)},children:"Cancel"}),(0,b.jsxs)(e.Button,{onClick:aa,className:"bg-primary hover:bg-primary/90",children:[(0,b.jsx)(u,{className:"w-4 h-4 mr-2"}),"Update Status"]})]})]})})]})},["staff"]);a.s(["default",0,D],65977)}];

//# sourceMappingURL=FWMS_app_dashboard_transportation_page_tsx_fbc008d1._.js.map