module.exports=[23474,a=>{"use strict";var b=a.i(76681),c=a.i(58273),d=a.i(76754);function e(a,e){return function(f){let g=(0,d.useRouter)(),[h,i]=(0,c.useState)(null);return((0,c.useEffect)(()=>{},[e,g]),h)?(0,b.jsx)(a,{...f,user:h}):null}}a.s(["withAuth",()=>e])},46294,a=>{"use strict";let b=(0,a.i(32269).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],46294)},2471,a=>{"use strict";var b=a.i(76681),c=a.i(18443);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card",className:(0,c.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...d})}a.s(["Card",()=>d])},37497,a=>{"use strict";let b=(0,a.i(32269).default)("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]);a.s(["Sprout",()=>b],37497)},83451,a=>{"use strict";let b=(0,a.i(32269).default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);a.s(["default",()=>b])},78189,a=>{"use strict";var b=a.i(83451);a.s(["Calendar",()=>b.default])},6256,a=>{"use strict";var b=a.i(76681),c=a.i(76754),d=a.i(42539);function e({title:a,onLogout:e}){let f=(0,c.useRouter)();return(0,b.jsx)("header",{className:"w-full bg-[#f5f3e9] border-b border-border",children:(0,b.jsxs)("div",{className:"mx-auto flex items-center justify-between px-4 py-3 max-w-6xl",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.default,{src:"/placeholder-logo.png",alt:"Logo",width:28,height:28,className:"h-7 w-7 object-contain"}),(0,b.jsx)("span",{className:"font-display font-semibold text-sm text-foreground",children:a})]}),(0,b.jsx)("button",{onClick:()=>{e?.(),f.push("/login")},className:"text-sm text-muted-foreground hover:text-foreground flex items-center gap-1",children:"Logout"})]})})}a.s(["RoleTopbar",()=>e])},23125,a=>{"use strict";var b=a.i(76681),c=a.i(58273),d=a.i(78189),e=a.i(46294),f=a.i(37497),g=a.i(2471),h=a.i(71594),i=a.i(6256),j=a.i(23474),k=a.i(25327);let l=(0,j.withAuth)(function({user:a}){let[j,l]=(0,c.useState)([]),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(!0),q=async()=>{try{let a=JSON.parse(localStorage.getItem("user")||"{}");if(!a.userId)return;let b=await fetch("/api/marketplace/waste",{headers:{"x-user-id":a.userId}});if(b.ok){let a=await b.json();l(a)}else{let b=await fetch("/api/farmer/available",{headers:{"x-user-id":a.userId}});if(b.ok){let a=await b.json();l(a)}}}catch(a){console.error("Error fetching available waste:",a)}finally{p(!1)}},r=async()=>{try{let a=JSON.parse(localStorage.getItem("user")||"{}");if(!a.userId)return;let b=await fetch("/api/farmer/requests",{headers:{"x-user-id":a.userId}});if(b.ok){let a=await b.json();n(a)}}catch(a){console.error("Error fetching my requests:",a)}};(0,c.useEffect)(()=>{q(),r();let a=setInterval(()=>{q(),r()},5e3);return()=>clearInterval(a)},[]);let s=async(a,b)=>{try{let c=JSON.parse(localStorage.getItem("user")||"{}");if(!c.userId)return void k.toast.error("Please log in again");let d=await fetch("/api/farmer/requests",{method:"POST",headers:{"Content-Type":"application/json","x-user-id":c.userId},body:JSON.stringify({wasteId:a,requesterId:c.userId})}),e=await d.json();d.ok?(k.toast.success("Collection Requested",{description:`Your request for ${b} has been submitted. Waiting for admin approval.`}),q(),r()):k.toast.error(e.error||"Failed to request collection")}catch(a){console.error("Error requesting collection:",a),k.toast.error("An error occurred. Please try again.")}},t=new Set(m.map(a=>a.wasteId));return(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsx)(i.RoleTopbar,{}),(0,b.jsx)("main",{className:"pt-24 px-4 pb-12",children:(0,b.jsxs)("div",{className:"container mx-auto max-w-6xl",children:[(0,b.jsxs)("div",{className:"text-center mb-12",children:[(0,b.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-500/10 mb-4",children:(0,b.jsx)(f.Sprout,{className:"w-8 h-8 text-green-600"})}),(0,b.jsx)("h1",{className:"font-display font-bold text-4xl text-foreground mb-3",children:"Farmer Portal"}),(0,b.jsx)("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Browse available organic waste and coffee grounds from local cafés for composting and farming"})]}),(0,b.jsxs)(g.Card,{className:"p-6 mb-8 bg-green-50 border-green-200",children:[(0,b.jsx)("h3",{className:"font-display font-bold text-lg text-green-900 mb-2",children:"How It Works"}),(0,b.jsxs)("ol",{className:"space-y-2 text-sm text-green-800",children:[(0,b.jsx)("li",{children:"1. Browse organic waste and coffee grounds available below"}),(0,b.jsx)("li",{children:'2. Click "Request Collection" for items you need'}),(0,b.jsx)("li",{children:"3. Wait for café admin approval (usually within 24 hours)"}),(0,b.jsx)("li",{children:"4. Once approved, coordinate collection time with the café"})]})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h2",{className:"font-display font-bold text-2xl text-foreground mb-4",children:"Available Organic Waste"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:o?"Loading...":`${j.length} item${1!==j.length?"s":""} available for collection`})]}),o?(0,b.jsx)(g.Card,{className:"p-12 text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"Loading available waste..."})}):0===j.length?(0,b.jsx)(g.Card,{className:"p-12 text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"No organic waste available at the moment. Check back later!"})}):(0,b.jsx)("div",{className:"grid gap-6",children:j.map(a=>{let c=t.has(a.id),i=m.find(b=>b.wasteId===a.id);return(0,b.jsx)(g.Card,{className:"p-6 hover:shadow-lg transition-shadow",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-6",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full bg-green-500/10 flex items-center justify-center flex-shrink-0",children:(0,b.jsx)(f.Sprout,{className:"w-6 h-6 text-green-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-display font-bold text-xl text-foreground",children:a.itemName}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Café ID: ",a.cafeId]})]})]}),(0,b.jsx)("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,b.jsx)(d.Calendar,{className:"w-4 h-4"}),(0,b.jsxs)("span",{className:"text-sm",children:["Available: ",(0,b.jsx)("span",{className:"font-medium text-foreground",children:a.expiryDate})]})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Quantity:"}),(0,b.jsxs)("span",{className:"font-bold text-lg text-foreground",children:[a.quantity," kg"]})]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Type: ",a.type]})]}),(0,b.jsx)("div",{className:"flex flex-col items-end gap-3",children:c?(0,b.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-primary",children:[(0,b.jsx)(e.CheckCircle,{className:"w-5 h-5"}),(0,b.jsx)("span",{className:"font-medium",children:i?.status==="approved"?"Approved":i?.status==="collected"?"Collected":i?.status==="rejected"?"Rejected":"Request Sent"})]}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Status: ",i?.status||"pending"]})]}):(0,b.jsxs)(h.Button,{onClick:()=>s(a.id,a.itemName),className:"bg-green-600 hover:bg-green-700 text-white",children:[(0,b.jsx)(f.Sprout,{className:"w-4 h-4 mr-2"}),"Request Collection"]})})]})},a.id)})})]})})]})},["farmer"]);a.s(["default",0,l])}];

//# sourceMappingURL=FWMS_fa3af61c._.js.map