{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/CS%20Y3/FYP/FWMS/FWMS/app/api/_data.ts"],"sourcesContent":["import type { User, WasteLog, PickupRequest, ActivityLog, Transport, Notification } from \"./_types\"\r\n\r\n// Dummy users (in-memory). Use x-user-id header to pick one.\r\nexport const users: User[] = [\r\n  {\r\n    id: \"u-admin-1\",\r\n    name: \"Alice Admin\",\r\n    email: \"alice@greencafe.com\",\r\n    passwordHash: \"password\", // TODO: hash passwords\r\n    role: \"admin\",\r\n    organizationName: \"Green Café\",\r\n    cafeId: \"cafe-1\",\r\n  },\r\n  {\r\n    id: \"u-staff-1\",\r\n    name: \"Sam Staff\",\r\n    email: \"sam@greencafe.com\",\r\n    passwordHash: \"password\",\r\n    role: \"staff\",\r\n    organizationName: \"Green Café\",\r\n    cafeId: \"cafe-1\",\r\n  },\r\n  {\r\n    id: \"u-charity-1\",\r\n    name: \"Charlie Charity\",\r\n    email: \"charity@help.org\",\r\n    passwordHash: \"password\",\r\n    role: \"charity\",\r\n    organizationName: \"Hope Charity\",\r\n    cafeId: null,\r\n  },\r\n  {\r\n    id: \"u-farmer-1\",\r\n    name: \"Fiona Farmer\",\r\n    email: \"farm@soil.com\",\r\n    passwordHash: \"password\",\r\n    role: \"farmer\",\r\n    organizationName: \"Soil & Co\",\r\n    cafeId: null,\r\n  },\r\n]\r\n\r\nexport const wasteLogs: WasteLog[] = [\r\n  {\r\n    id: \"w1\",\r\n    cafeId: \"cafe-1\",\r\n    type: \"edible\",\r\n    itemName: \"Pastries\",\r\n    quantity: 15,\r\n    expiryDate: \"2025-12-05\",\r\n    status: \"pending\",\r\n    assignedTo: \"charity\",\r\n    createdAt: \"2025-12-01T08:00:00Z\",\r\n    updatedAt: \"2025-12-01T08:00:00Z\",\r\n  },\r\n  {\r\n    id: \"w2\",\r\n    cafeId: \"cafe-1\",\r\n    type: \"organic\",\r\n    itemName: \"Vegetable Scraps\",\r\n    quantity: 22,\r\n    expiryDate: \"2025-12-04\",\r\n    status: \"pending\",\r\n    assignedTo: \"farmer\",\r\n    createdAt: \"2025-12-01T09:00:00Z\",\r\n    updatedAt: \"2025-12-01T09:00:00Z\",\r\n  },\r\n  {\r\n    id: \"w3\",\r\n    cafeId: \"cafe-1\",\r\n    type: \"coffee\",\r\n    itemName: \"Coffee Grounds\",\r\n    quantity: 10,\r\n    expiryDate: \"2025-12-03\",\r\n    status: \"collected\",\r\n    assignedTo: \"farmer\",\r\n    createdAt: \"2025-11-30T10:00:00Z\",\r\n    updatedAt: \"2025-12-01T10:00:00Z\",\r\n  },\r\n  {\r\n    id: \"w4\",\r\n    cafeId: \"cafe-1\",\r\n    type: \"edible\",\r\n    itemName: \"Sandwiches\",\r\n    quantity: 8,\r\n    expiryDate: \"2025-12-02\",\r\n    status: \"dropped\",\r\n    assignedTo: \"charity\",\r\n    createdAt: \"2025-11-30T11:00:00Z\",\r\n    updatedAt: \"2025-12-01T11:00:00Z\",\r\n  },\r\n  // Add more available items for charity\r\n  {\r\n    id: \"w5\",\r\n    cafeId: \"cafe-1\",\r\n    type: \"edible\",\r\n    itemName: \"Fresh Bread\",\r\n    quantity: 12,\r\n    expiryDate: \"2025-12-10\",\r\n    status: \"pending\",\r\n    assignedTo: \"charity\",\r\n    createdAt: new Date().toISOString(),\r\n    updatedAt: new Date().toISOString(),\r\n  },\r\n  {\r\n    id: \"w6\",\r\n    cafeId: \"cafe-1\",\r\n    type: \"edible\",\r\n    itemName: \"Muffins & Croissants\",\r\n    quantity: 20,\r\n    expiryDate: \"2025-12-08\",\r\n    status: \"pending\",\r\n    assignedTo: \"charity\",\r\n    createdAt: new Date().toISOString(),\r\n    updatedAt: new Date().toISOString(),\r\n  },\r\n  // Add more available items for farmer\r\n  {\r\n    id: \"w7\",\r\n    cafeId: \"cafe-1\",\r\n    type: \"organic\",\r\n    itemName: \"Fruit Peels\",\r\n    quantity: 15,\r\n    expiryDate: \"2025-12-09\",\r\n    status: \"pending\",\r\n    assignedTo: \"farmer\",\r\n    createdAt: new Date().toISOString(),\r\n    updatedAt: new Date().toISOString(),\r\n  },\r\n  {\r\n    id: \"w8\",\r\n    cafeId: \"cafe-1\",\r\n    type: \"coffee\",\r\n    itemName: \"Used Coffee Grounds\",\r\n    quantity: 18,\r\n    expiryDate: \"2025-12-07\",\r\n    status: \"pending\",\r\n    assignedTo: \"farmer\",\r\n    createdAt: new Date().toISOString(),\r\n    updatedAt: new Date().toISOString(),\r\n  },\r\n]\r\n\r\nexport const pickupRequests: PickupRequest[] = [\r\n  {\r\n    id: \"p1\",\r\n    wasteId: \"w1\",\r\n    requesterId: \"u-charity-1\",\r\n    requesterType: \"charity\",\r\n    requestedAt: \"2025-12-01T12:00:00Z\",\r\n    status: \"pending\",\r\n    preferredTime: \"Morning\",\r\n  },\r\n  {\r\n    id: \"p2\",\r\n    wasteId: \"w2\",\r\n    requesterId: \"u-farmer-1\",\r\n    requesterType: \"farmer\",\r\n    requestedAt: \"2025-12-01T13:00:00Z\",\r\n    status: \"approved\",\r\n  },\r\n  {\r\n    id: \"p3\",\r\n    wasteId: \"w3\",\r\n    requesterId: \"u-farmer-1\",\r\n    requesterType: \"farmer\",\r\n    requestedAt: \"2025-11-30T13:00:00Z\",\r\n    status: \"collected\",\r\n  },\r\n]\r\n\r\nexport const activityLogs: ActivityLog[] = [\r\n  {\r\n    id: \"a1\",\r\n    userId: \"u-staff-1\",\r\n    actionType: \"logged\",\r\n    itemName: \"Pastries\",\r\n    createdAt: \"2025-12-01T08:00:00Z\",\r\n  },\r\n  {\r\n    id: \"a2\",\r\n    userId: \"u-charity-1\",\r\n    actionType: \"donationRequested\",\r\n    itemName: \"Pastries\",\r\n    createdAt: \"2025-12-01T12:05:00Z\",\r\n  },\r\n  {\r\n    id: \"a3\",\r\n    userId: \"u-farmer-1\",\r\n    actionType: \"farmRequest\",\r\n    itemName: \"Vegetable Scraps\",\r\n    createdAt: \"2025-12-01T13:05:00Z\",\r\n  },\r\n  {\r\n    id: \"a4\",\r\n    userId: \"u-admin-1\",\r\n    actionType: \"dropped\",\r\n    itemName: \"Sandwiches\",\r\n    createdAt: \"2025-12-01T14:00:00Z\",\r\n  },\r\n]\r\n\r\nexport const transports: Transport[] = []\r\n\r\nexport const notifications: Notification[] = []\r\n\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAGO,MAAM,QAAgB;IAC3B;QACE,IAAI;QACJ,MAAM;QACN,OAAO;QACP,cAAc;QACd,MAAM;QACN,kBAAkB;QAClB,QAAQ;IACV;IACA;QACE,IAAI;QACJ,MAAM;QACN,OAAO;QACP,cAAc;QACd,MAAM;QACN,kBAAkB;QAClB,QAAQ;IACV;IACA;QACE,IAAI;QACJ,MAAM;QACN,OAAO;QACP,cAAc;QACd,MAAM;QACN,kBAAkB;QAClB,QAAQ;IACV;IACA;QACE,IAAI;QACJ,MAAM;QACN,OAAO;QACP,cAAc;QACd,MAAM;QACN,kBAAkB;QAClB,QAAQ;IACV;CACD;AAEM,MAAM,YAAwB;IACnC;QACE,IAAI;QACJ,QAAQ;QACR,MAAM;QACN,UAAU;QACV,UAAU;QACV,YAAY;QACZ,QAAQ;QACR,YAAY;QACZ,WAAW;QACX,WAAW;IACb;IACA;QACE,IAAI;QACJ,QAAQ;QACR,MAAM;QACN,UAAU;QACV,UAAU;QACV,YAAY;QACZ,QAAQ;QACR,YAAY;QACZ,WAAW;QACX,WAAW;IACb;IACA;QACE,IAAI;QACJ,QAAQ;QACR,MAAM;QACN,UAAU;QACV,UAAU;QACV,YAAY;QACZ,QAAQ;QACR,YAAY;QACZ,WAAW;QACX,WAAW;IACb;IACA;QACE,IAAI;QACJ,QAAQ;QACR,MAAM;QACN,UAAU;QACV,UAAU;QACV,YAAY;QACZ,QAAQ;QACR,YAAY;QACZ,WAAW;QACX,WAAW;IACb;IACA,uCAAuC;IACvC;QACE,IAAI;QACJ,QAAQ;QACR,MAAM;QACN,UAAU;QACV,UAAU;QACV,YAAY;QACZ,QAAQ;QACR,YAAY;QACZ,WAAW,IAAI,OAAO,WAAW;QACjC,WAAW,IAAI,OAAO,WAAW;IACnC;IACA;QACE,IAAI;QACJ,QAAQ;QACR,MAAM;QACN,UAAU;QACV,UAAU;QACV,YAAY;QACZ,QAAQ;QACR,YAAY;QACZ,WAAW,IAAI,OAAO,WAAW;QACjC,WAAW,IAAI,OAAO,WAAW;IACnC;IACA,sCAAsC;IACtC;QACE,IAAI;QACJ,QAAQ;QACR,MAAM;QACN,UAAU;QACV,UAAU;QACV,YAAY;QACZ,QAAQ;QACR,YAAY;QACZ,WAAW,IAAI,OAAO,WAAW;QACjC,WAAW,IAAI,OAAO,WAAW;IACnC;IACA;QACE,IAAI;QACJ,QAAQ;QACR,MAAM;QACN,UAAU;QACV,UAAU;QACV,YAAY;QACZ,QAAQ;QACR,YAAY;QACZ,WAAW,IAAI,OAAO,WAAW;QACjC,WAAW,IAAI,OAAO,WAAW;IACnC;CACD;AAEM,MAAM,iBAAkC;IAC7C;QACE,IAAI;QACJ,SAAS;QACT,aAAa;QACb,eAAe;QACf,aAAa;QACb,QAAQ;QACR,eAAe;IACjB;IACA;QACE,IAAI;QACJ,SAAS;QACT,aAAa;QACb,eAAe;QACf,aAAa;QACb,QAAQ;IACV;IACA;QACE,IAAI;QACJ,SAAS;QACT,aAAa;QACb,eAAe;QACf,aAAa;QACb,QAAQ;IACV;CACD;AAEM,MAAM,eAA8B;IACzC;QACE,IAAI;QACJ,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,WAAW;IACb;IACA;QACE,IAAI;QACJ,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,WAAW;IACb;IACA;QACE,IAAI;QACJ,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,WAAW;IACb;IACA;QACE,IAAI;QACJ,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,WAAW;IACb;CACD;AAEM,MAAM,aAA0B,EAAE;AAElC,MAAM,gBAAgC,EAAE","debugId":null}},
    {"offset": {"line": 261, "column": 0}, "map": {"version":3,"sources":["file:///D:/CS%20Y3/FYP/FWMS/FWMS/app/api/transports/%5Bid%5D/complete/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\r\nimport { transports, pickupRequests, activityLogs, users, wasteLogs, notifications } from \"@/app/api/_data\"\r\n\r\n// PATCH /api/transports/[id]/complete\r\n// Marks a transport and pickup request as completed\r\nexport async function PATCH(\r\n  req: NextRequest,\r\n  { params }: { params: { id: string } }\r\n) {\r\n  const userId = req.headers.get(\"x-user-id\")\r\n  if (!userId) {\r\n    return NextResponse.json({ error: \"Missing user ID\" }, { status: 400 })\r\n  }\r\n\r\n  const user = users.find((u) => u.id === userId)\r\n  if (!user || (user.role !== \"admin\" && user.role !== \"staff\")) {\r\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 403 })\r\n  }\r\n\r\n  const transportId = params.id\r\n  const body = await req.json()\r\n  const { pickupRequestId } = body\r\n\r\n  if (!pickupRequestId) {\r\n    return NextResponse.json({ error: \"Missing pickupRequestId\" }, { status: 400 })\r\n  }\r\n\r\n  const transport = transports.find((t) => t.id === transportId)\r\n  if (!transport) {\r\n    return NextResponse.json({ error: \"Transport not found\" }, { status: 404 })\r\n  }\r\n\r\n  const pickupRequest = pickupRequests.find((p) => p.id === pickupRequestId)\r\n  if (!pickupRequest) {\r\n    return NextResponse.json({ error: \"Pickup request not found\" }, { status: 404 })\r\n  }\r\n\r\n  // Update transport status\r\n  transport.status = \"completed\"\r\n  transport.updatedAt = new Date().toISOString()\r\n\r\n  // Update pickup request status\r\n  pickupRequest.status = \"completed\"\r\n\r\n  // Update waste status\r\n  const waste = wasteLogs.find((w) => w.id === pickupRequest.wasteId)\r\n  if (waste) {\r\n    waste.status = \"collected\"\r\n    waste.updatedAt = new Date().toISOString()\r\n  }\r\n\r\n  // Add activity log\r\n  const now = new Date().toISOString()\r\n  activityLogs.push({\r\n    id: `a-${Date.now()}`,\r\n    userId: user.id,\r\n    actionType: \"collected\",\r\n    itemName: waste?.itemName || \"Unknown\",\r\n    createdAt: now,\r\n    requesterType: pickupRequest.requesterType,\r\n  })\r\n\r\n  // Create notification for charity/farmer\r\n  notifications.push({\r\n    id: `n-${Date.now()}`,\r\n    userId: pickupRequest.requesterId,\r\n    type: \"pickup-completed\",\r\n    title: \"Pickup Completed\",\r\n    message: `Your pickup for \"${waste?.itemName || \"item\"}\" has been completed. Thank you for helping reduce food waste!`,\r\n    read: false,\r\n    createdAt: now,\r\n    relatedRequestId: pickupRequest.id,\r\n  })\r\n\r\n  return NextResponse.json({ transport, pickupRequest, waste })\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAIO,eAAe,MACpB,GAAgB,EAChB,EAAE,MAAM,EAA8B;IAEtC,MAAM,SAAS,IAAI,OAAO,CAAC,GAAG,CAAC;IAC/B,IAAI,CAAC,QAAQ;QACX,OAAO,wJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAkB,GAAG;YAAE,QAAQ;QAAI;IACvE;IAEA,MAAM,OAAO,sIAAK,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IACxC,IAAI,CAAC,QAAS,KAAK,IAAI,KAAK,WAAW,KAAK,IAAI,KAAK,SAAU;QAC7D,OAAO,wJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;IAEA,MAAM,cAAc,OAAO,EAAE;IAC7B,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,MAAM,EAAE,eAAe,EAAE,GAAG;IAE5B,IAAI,CAAC,iBAAiB;QACpB,OAAO,wJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA0B,GAAG;YAAE,QAAQ;QAAI;IAC/E;IAEA,MAAM,YAAY,2IAAU,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IAClD,IAAI,CAAC,WAAW;QACd,OAAO,wJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAsB,GAAG;YAAE,QAAQ;QAAI;IAC3E;IAEA,MAAM,gBAAgB,+IAAc,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IAC1D,IAAI,CAAC,eAAe;QAClB,OAAO,wJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA2B,GAAG;YAAE,QAAQ;QAAI;IAChF;IAEA,0BAA0B;IAC1B,UAAU,MAAM,GAAG;IACnB,UAAU,SAAS,GAAG,IAAI,OAAO,WAAW;IAE5C,+BAA+B;IAC/B,cAAc,MAAM,GAAG;IAEvB,sBAAsB;IACtB,MAAM,QAAQ,0IAAS,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,cAAc,OAAO;IAClE,IAAI,OAAO;QACT,MAAM,MAAM,GAAG;QACf,MAAM,SAAS,GAAG,IAAI,OAAO,WAAW;IAC1C;IAEA,mBAAmB;IACnB,MAAM,MAAM,IAAI,OAAO,WAAW;IAClC,6IAAY,CAAC,IAAI,CAAC;QAChB,IAAI,CAAC,EAAE,EAAE,KAAK,GAAG,IAAI;QACrB,QAAQ,KAAK,EAAE;QACf,YAAY;QACZ,UAAU,OAAO,YAAY;QAC7B,WAAW;QACX,eAAe,cAAc,aAAa;IAC5C;IAEA,yCAAyC;IACzC,8IAAa,CAAC,IAAI,CAAC;QACjB,IAAI,CAAC,EAAE,EAAE,KAAK,GAAG,IAAI;QACrB,QAAQ,cAAc,WAAW;QACjC,MAAM;QACN,OAAO;QACP,SAAS,CAAC,iBAAiB,EAAE,OAAO,YAAY,OAAO,8DAA8D,CAAC;QACtH,MAAM;QACN,WAAW;QACX,kBAAkB,cAAc,EAAE;IACpC;IAEA,OAAO,wJAAY,CAAC,IAAI,CAAC;QAAE;QAAW;QAAe;IAAM;AAC7D","debugId":null}}]
}