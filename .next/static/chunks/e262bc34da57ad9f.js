(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,90840,e=>{"use strict";var t=e.i(19063),r=e.i(96083),s=e.i(28739),a=e.i(80120),i=e.i(75233),n=e.i(4960),l=e.i(30003);let o=(0,n.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function d({className:e,variant:r,asChild:s=!1,...a}){let n=s?i.Slot:"span";return(0,t.jsx)(n,{"data-slot":"badge",className:(0,l.cn)(o({variant:r}),e),...a})}var c=e.i(75815),u=e.i(19458),m=e.i(89871),p=e.i(53744),h=e.i(50245),x=e.i(18165);function f({value:e,onChange:r,className:s}){let[a,i]=(e||"12:00").split(":").map(Number),n=a||12,[o,d]=x.useState(n>12?n-12:0===n?12:n),[c,u]=x.useState(i||0),[m,p]=x.useState(n>=12?"PM":"AM"),h=x.useRef(null),f=x.useRef(null),g=x.useRef(null),v=Array.from({length:12},(e,t)=>t+1),y=Array.from({length:60},(e,t)=>t),j=x.useRef(!1),b=x.useRef(""),N=x.useRef(r);x.useEffect(()=>{N.current=r},[r]),x.useEffect(()=>{if(j.current){j.current=!1;return}let e=o;"PM"===m&&12!==o?e=o+12:"AM"===m&&12===o&&(e=0);let t=`${String(e).padStart(2,"0")}:${String(c).padStart(2,"0")}`;t!==b.current&&(b.current=t,N.current(t))},[o,c,m]),x.useEffect(()=>{let t=e||"12:00";if(t===b.current)return;let[r,s]=t.split(":").map(Number),a=r||12,i=a>12?a-12:0===a?12:a,n=a>=12?"PM":"AM";(o!==i||c!==(s||0)||m!==n)&&(j.current=!0,b.current=t,d(i),u(s||0),p(n))},[e,o,c,m]),x.useEffect(()=>{if(h.current){let e=v.indexOf(o);e>=0&&(h.current.scrollTop=40*e)}},[o,v]),x.useEffect(()=>{f.current&&(f.current.scrollTop=40*c)},[c]),x.useEffect(()=>{if(g.current){let e=+("AM"!==m);g.current.scrollTop=40*e}},[m]);let w=(e,t)=>{if(!t.current)return;let r=Math.round(t.current.scrollTop/40);if("hour"===e)d(v[r]||v[0]),t.current.scrollTo({top:40*r,behavior:"smooth"});else if("minute"===e){let e=Math.max(0,Math.min(59,r));u(e),t.current.scrollTo({top:40*e,behavior:"smooth"})}else p(0===r?"AM":"PM"),t.current.scrollTo({top:40*r,behavior:"smooth"})},k=(e,t,r)=>{if("hour"===e){d(t);let e=v.indexOf(t);r.current&&e>=0&&r.current.scrollTo({top:40*e,behavior:"smooth"})}else if("minute"===e)u(t),r.current&&r.current.scrollTo({top:40*t,behavior:"smooth"});else{p(t);let e=+("AM"!==t);r.current&&r.current.scrollTo({top:40*e,behavior:"smooth"})}};return(0,t.jsxs)("div",{className:(0,l.cn)("flex items-center gap-1 bg-muted/30 rounded-lg p-3 border",s),children:[(0,t.jsxs)("div",{className:"flex-1 relative h-40 overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 h-10 border-t-2 border-b-2 border-primary/30 pointer-events-none z-10"}),(0,t.jsx)("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 h-10 bg-primary/5 pointer-events-none z-0"}),(0,t.jsx)("div",{ref:h,className:"h-full overflow-y-scroll scroll-smooth snap-y snap-mandatory hide-scrollbar",onScroll:()=>w("hour",h),style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:(0,t.jsx)("div",{className:"py-16",children:v.map(e=>(0,t.jsx)("div",{className:(0,l.cn)("h-10 flex items-center justify-center text-lg font-medium cursor-pointer transition-all snap-center",o===e?"text-primary font-bold scale-110":"text-muted-foreground hover:text-foreground"),onClick:()=>k("hour",e,h),children:String(e).padStart(2,"0")},e))})})]}),(0,t.jsx)("div",{className:"text-2xl font-bold text-muted-foreground px-1",children:":"}),(0,t.jsxs)("div",{className:"flex-1 relative h-40 overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 h-10 border-t-2 border-b-2 border-primary/30 pointer-events-none z-10"}),(0,t.jsx)("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 h-10 bg-primary/5 pointer-events-none z-0"}),(0,t.jsx)("div",{ref:f,className:"h-full overflow-y-scroll scroll-smooth snap-y snap-mandatory hide-scrollbar",onScroll:()=>w("minute",f),style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:(0,t.jsx)("div",{className:"py-16",children:y.map(e=>(0,t.jsx)("div",{className:(0,l.cn)("h-10 flex items-center justify-center text-lg font-medium cursor-pointer transition-all snap-center",c===e?"text-primary font-bold scale-110":"text-muted-foreground hover:text-foreground"),onClick:()=>k("minute",e,f),children:String(e).padStart(2,"0")},e))})})]}),(0,t.jsxs)("div",{className:"flex-1 relative h-40 overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 h-10 border-t-2 border-b-2 border-primary/30 pointer-events-none z-10"}),(0,t.jsx)("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 h-10 bg-primary/5 pointer-events-none z-0"}),(0,t.jsx)("div",{ref:g,className:"h-full overflow-y-scroll scroll-smooth snap-y snap-mandatory hide-scrollbar",onScroll:()=>w("ampm",g),style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:(0,t.jsx)("div",{className:"py-16",children:["AM","PM"].map(e=>(0,t.jsx)("div",{className:(0,l.cn)("h-10 flex items-center justify-center text-lg font-medium cursor-pointer transition-all snap-center",m===e?"text-primary font-bold scale-110":"text-muted-foreground hover:text-foreground"),onClick:()=>k("ampm",e,g),children:e},e))})})]})]})}var g=e.i(90593),v=e.i(87854),y=e.i(81033);let j=(0,y.default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var b=e.i(32565);let N=(0,y.default)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),w=(0,y.default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var k=e.i(80019);let T=(0,y.default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var S=e.i(4156),C=e.i(94557),q=e.i(87285);let I=(0,C.withAuth)(function(){let[e,i]=(0,x.useState)([]),[n,l]=(0,x.useState)([]),[o,y]=(0,x.useState)(!0),[C,I]=(0,x.useState)(!1),[D,E]=(0,x.useState)(!1),[L,A]=(0,x.useState)(!1),[P,R]=(0,x.useState)(null),[M,O]=(0,x.useState)("SCHEDULED"),[U,$]=(0,x.useState)(""),[F,W]=(0,x.useState)(!1),[z,B]=(0,x.useState)({requesterId:"",wasteType:"",quantity:"",requesterName:"",pickupMethod:"staff",assignedTo:"",pickupDate:"",pickupWindowFrom:"",pickupWindowTo:"",status:"scheduled",notes:""}),H=e.filter(e=>{let t=e.status.toLowerCase();return"scheduled"===t||"pickup-scheduled"===t||"completed"===t||"in-transit"===t||"in_transit"===t||"cancelled"===t}),V=H.filter(e=>{let t=e.status.toLowerCase();return"scheduled"===t||"pickup-scheduled"===t}).length,_=H.filter(e=>{let t=e.status.toLowerCase();return"in-transit"===t||"in_transit"===t||"in transit"===t}).length,J=H.filter(e=>{let t=e.status.toLowerCase();return"completed"===t||"delivered"===t}).length,G=H.reduce((e,t)=>e+(t.quantity||t.pickupRequest?.quantity||0),0);(0,x.useEffect)(()=>{Q()},[]);let Q=async()=>{try{let e=JSON.parse(localStorage.getItem("user")||"{}");if(!e.userId)return;let t=await fetch("/api/admin/transportations",{headers:{"x-user-id":e.userId}});if(t.ok){let e=((await t.json()).transportations||[]).map(e=>{let t=e.wasteType||e.itemName||"Unknown",r=e.quantity||0,s=e.requesterName||e.destination||"Unknown",a=e.requesterName||s,i=(e.pickupRequestId||e.id).substring(0,6).toUpperCase(),n=`${a}-${i}`;return{id:e.id,pickupRequestId:e.pickupRequestId||"",wasteEntryId:e.wasteEntryId||"",transportType:e.pickupRequestId?"internal":"external",assignedTo:e.driverName||void 0,pickupDate:e.scheduledDate||"",pickupWindow:{from:e.scheduledTime?.split("-")[0]||"",to:e.scheduledTime?.split("-")[1]||""},notes:e.notes||void 0,status:e.status||"SCHEDULED",destination:s,quantity:r,wasteType:t,requesterId:e.pickupRequestId||e.id,formattedRequesterId:n,businessName:a,pickupRequest:{itemName:e.itemName||t,quantity:r,requesterName:a}}});i(e)}}catch(e){console.error("Error fetching transports:",e)}finally{y(!1)}},K=async()=>{I(!0);try{let e=JSON.parse(localStorage.getItem("user")||"{}");if(!e.userId)return;let t=await fetch("/api/admin/pickups/approved",{headers:{"x-user-id":e.userId}});if(t.ok){let e=await t.json();l(e.approvedPickups||[])}}catch(e){console.error("Error fetching approved pickups:",e)}finally{I(!1)}},Y=async()=>{if(!U&&!F)return void q.toast.error("Please select an approved pickup request");if(!z.pickupDate||!z.pickupWindowFrom||!z.pickupWindowTo)return void q.toast.error("Please fill in date and time fields");if(!z.assignedTo)return void q.toast.error("Please enter driver/staff name");try{let e=JSON.parse(localStorage.getItem("user")||"{}");if(!e.userId)return void q.toast.error("Please log in again");let t=`${z.pickupWindowFrom}-${z.pickupWindowTo}`,r=[`Driver: ${z.assignedTo}`,`Pickup Method: ${"staff"===z.pickupMethod?"Café staff":"External courier (Grab / Lalamove)"}`,z.notes].filter(Boolean).join("\n"),s=await fetch("/api/admin/transportations",{method:"POST",headers:{"Content-Type":"application/json","x-user-id":e.userId},body:JSON.stringify({pickupRequestId:"admin-override"===U?z.requesterId:U,scheduledDate:z.pickupDate,scheduledTime:t,driverName:z.assignedTo,notes:r,isAdminOverride:F,manualDestination:F?z.requesterName:void 0,manualQuantity:F?parseFloat(z.quantity):void 0,manualWasteType:F?z.wasteType:void 0})});if(s.ok)q.toast.success("Transportation scheduled successfully"),E(!1),B({requesterId:"",wasteType:"",quantity:"",requesterName:"",pickupMethod:"staff",assignedTo:"",pickupDate:"",pickupWindowFrom:"",pickupWindowTo:"",status:"scheduled",notes:""}),$(""),W(!1),Q();else{let e=await s.json();q.toast.error(e.error||"Failed to schedule transportation")}}catch(e){console.error("Error scheduling pickup:",e),q.toast.error("An error occurred. Please try again.")}},X=async(e,t)=>{try{let t=JSON.parse(localStorage.getItem("user")||"{}");if(!t.userId)return void q.toast.error("User not found. Please log in again");let r=await fetch(`/api/admin/transportations/${e}/complete`,{method:"PATCH",headers:{"Content-Type":"application/json","x-user-id":t.userId}});if(r.ok){let e=await r.json();q.toast.success(`Completed! ${e.data?.pointsAwarded||0} points awarded`),Q()}else{let e=await r.json();q.toast.error(e.error||"Failed to mark as completed")}}catch(e){console.error("Error marking as completed:",e),q.toast.error("An error occurred. Please try again.")}},Z=async e=>{if(confirm("Are you sure you want to delete this transportation record? This action cannot be undone."))try{let t=JSON.parse(localStorage.getItem("user")||"{}");if(!t.userId)return void q.toast.error("User not found. Please log in again");let r=await fetch(`/api/transportation/${e}`,{method:"DELETE",headers:{"x-user-id":t.userId}});if(r.ok)q.toast.success("Transportation record deleted successfully"),Q();else{let e=await r.json();q.toast.error(e.error||"Failed to delete transportation record")}}catch(e){console.error("Error deleting transportation record:",e),q.toast.error("An error occurred. Please try again.")}},ee=async()=>{if(P)try{let e=JSON.parse(localStorage.getItem("user")||"{}");if(!e.userId)return void q.toast.error("User not found. Please log in again");if("COMPLETED"===M){let t=await fetch(`/api/admin/transportations/${P.id}/complete`,{method:"PATCH",headers:{"Content-Type":"application/json","x-user-id":e.userId}});if(t.ok){let e=await t.json();q.toast.success(`Completed! ${e.data?.pointsAwarded||0} points awarded`),A(!1),R(null),Q()}else{let e=await t.json();q.toast.error(e.error||"Failed to complete")}return}let t=await fetch(`/api/transportation/${P.id}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-user-id":e.userId},body:JSON.stringify({status:M})});if(t.ok)q.toast.success("Status updated successfully"),A(!1),R(null),Q();else{let e=await t.json();q.toast.error(e.error||"Failed to update status")}}catch(e){console.error("Error updating status:",e),q.toast.error("An error occurred. Please try again.")}};return(0,t.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,t.jsx)(r.DashboardNav,{}),(0,t.jsx)("main",{className:"pt-20 px-4 pb-8",children:(0,t.jsxs)("div",{className:"container mx-auto max-w-7xl",children:[(0,t.jsxs)("div",{className:"mb-6 flex items-start gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(v.Truck,{className:"w-6 h-6 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"font-display font-bold text-3xl text-foreground mb-1",children:"Transportation Organizer"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Manage food waste pickups and deliveries"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,t.jsxs)(s.Card,{className:"p-6 hover:shadow-lg transition-shadow bg-gradient-to-br from-yellow-50 to-background border-2 border-yellow-500/20",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,t.jsx)("div",{className:"w-12 h-12 rounded-xl bg-yellow-500/10 flex items-center justify-center",children:(0,t.jsx)(g.Clock,{className:"w-6 h-6 text-yellow-600"})})}),(0,t.jsx)("div",{className:"text-3xl font-display font-bold text-foreground mb-1",children:V}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground font-medium",children:"Scheduled Pickups"}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:"Upcoming waste collections"})]}),(0,t.jsxs)(s.Card,{className:"p-6 hover:shadow-lg transition-shadow bg-gradient-to-br from-blue-50 to-background border-2 border-blue-500/20",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,t.jsx)("div",{className:"w-12 h-12 rounded-xl bg-blue-500/10 flex items-center justify-center",children:(0,t.jsx)(v.Truck,{className:"w-6 h-6 text-blue-600"})})}),(0,t.jsx)("div",{className:"text-3xl font-display font-bold text-foreground mb-1",children:_}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground font-medium",children:"In Transit"}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:"Active deliveries in progress"})]}),(0,t.jsxs)(s.Card,{className:"p-6 hover:shadow-lg transition-shadow bg-gradient-to-br from-green-50 to-background border-2 border-primary/20",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,t.jsx)("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center",children:(0,t.jsx)(j,{className:"w-6 h-6 text-primary"})})}),(0,t.jsx)("div",{className:"text-3xl font-display font-bold text-foreground mb-1",children:J}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground font-medium",children:"Completed Deliveries"}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:"Total finished transports"})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-3 mb-6",children:[(0,t.jsxs)(a.Button,{className:"bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>{K(),E(!0)},children:[(0,t.jsx)(v.Truck,{className:"w-4 h-4 mr-2"}),"Schedule Transportation"]}),(0,t.jsx)(a.Button,{variant:"outline",className:"border-primary/20 hover:bg-primary/5 bg-transparent",children:"Update Status"})]}),(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsxs)(s.Card,{className:"p-6 bg-card",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h3",{className:"font-display font-bold text-xl text-foreground",children:"Transport Requests"}),(0,t.jsx)(a.Button,{variant:"outline",size:"sm",onClick:()=>{if(0===H.length)return void q.toast.error("No data to export");let e=new Blob([["Requester ID,Café,Destination,Type,Quantity (kg),Status,Pickup Date,Pickup Time,Assigned To",...H.map(e=>{let t=e.destination||e.pickupRequest?.requesterName||"Unknown",r=e.wasteType||e.pickupRequest?.itemName||"Unknown",s=e.quantity||e.pickupRequest?.quantity||0,a=e.pickupDate?new Date(e.pickupDate).toLocaleDateString():"",i=e.pickupWindow?.from&&e.pickupWindow?.to?`${e.pickupWindow.from} - ${e.pickupWindow.to}`:"",n=e.assignedTo||"";return[`"${e.formattedRequesterId||e.businessName?`${e.businessName}-${(e.requesterId||e.id).substring(0,6).toUpperCase()}`:e.requesterId||e.id}"`,`"Green Caf\xe9"`,`"${t}"`,`"${r}"`,s,`"${e.status}"`,`"${a}"`,`"${i}"`,`"${n}"`].join(",")})].join("\n")],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),r=URL.createObjectURL(e);t.setAttribute("href",r),t.setAttribute("download",`transportation-records-${new Date().toISOString().split("T")[0]}.csv`),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t),q.toast.success("Transportation records exported successfully")},children:"Export"})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-border bg-muted/50",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 font-display font-semibold text-sm text-muted-foreground",children:"Requester ID"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-display font-semibold text-sm text-muted-foreground",children:"Café"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-display font-semibold text-sm text-muted-foreground",children:"Destination"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-display font-semibold text-sm text-muted-foreground",children:"Type"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-display font-semibold text-sm text-muted-foreground",children:"Quantity"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-display font-semibold text-sm text-muted-foreground",children:"Status"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-display font-semibold text-sm text-muted-foreground",children:"Action"})]})}),(0,t.jsx)("tbody",{children:H.map(e=>{let r,s,i=e.destination||e.pickupRequest?.requesterName||"Unknown",n=e.wasteType||e.pickupRequest?.itemName||"Unknown",l=e.quantity||e.pickupRequest?.quantity||0;return(0,t.jsxs)("tr",{className:"border-b border-border hover:bg-accent/5 transition-colors",children:[(0,t.jsx)("td",{className:"py-4 px-4 font-medium text-foreground",children:e.formattedRequesterId||e.businessName?`${e.businessName}-${(e.requesterId||e.id).substring(0,6).toUpperCase()}`:e.requesterId||e.id}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:(0,t.jsx)(N,{className:"w-4 h-4 text-primary"})}),(0,t.jsx)("span",{className:"text-foreground",children:"Green Café"})]})}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(b.MapPin,{className:"w-4 h-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-foreground",children:i})]})}),(0,t.jsx)("td",{className:"py-4 px-4 text-muted-foreground",children:n}),(0,t.jsxs)("td",{className:"py-4 px-4 font-medium text-foreground",children:[l," kg"]}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)(d,{variant:"outline",className:"scheduled"===(r=e.status.toLowerCase())||"pickup-scheduled"===r?"bg-yellow-500/10 text-yellow-600 border-yellow-500/20":"in-transit"===r||"in_transit"===r||"in transit"===r?"bg-blue-500/10 text-blue-600 border-blue-500/20":"completed"===r||"delivered"===r?"bg-primary/10 text-primary border-primary/20":"cancelled"===r?"bg-red-500/10 text-red-600 border-red-500/20":"bg-muted text-muted-foreground",children:(0,t.jsxs)("span",{className:"flex items-center gap-1.5",children:["scheduled"===(s=e.status.toLowerCase())||"pickup-scheduled"===s?(0,t.jsx)(g.Clock,{className:"w-4 h-4"}):"in-transit"===s||"in_transit"===s||"in transit"===s?(0,t.jsx)(v.Truck,{className:"w-4 h-4"}):"completed"===s||"delivered"===s?(0,t.jsx)(j,{className:"w-4 h-4"}):null,e.status]})})}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["pickup-scheduled"===e.status||"scheduled"===e.status||"Scheduled"===e.status?(0,t.jsxs)(a.Button,{variant:"outline",size:"sm",onClick:()=>X(e.id,e.pickupRequestId),className:"hover:bg-green-500/10 hover:text-green-600",children:[(0,t.jsx)(j,{className:"w-4 h-4 mr-1"}),"Mark as Completed"]}):(0,t.jsxs)(a.Button,{variant:"ghost",size:"sm",className:"hover:bg-primary/10 hover:text-primary",children:[(0,t.jsx)(w,{className:"w-4 h-4 mr-1"}),"View"]}),(0,t.jsx)(a.Button,{variant:"ghost",size:"sm",onClick:()=>(R(e),void(O({SCHEDULED:"SCHEDULED",scheduled:"SCHEDULED",Scheduled:"SCHEDULED",IN_TRANSIT:"IN_TRANSIT","in-transit":"IN_TRANSIT","In Transit":"IN_TRANSIT",COMPLETED:"COMPLETED",completed:"COMPLETED",Completed:"COMPLETED",delivered:"COMPLETED",CANCELLED:"CANCELLED",cancelled:"CANCELLED"}[e.status]||"SCHEDULED"),A(!0))),className:"hover:bg-blue-500/10 hover:text-blue-600",children:(0,t.jsx)(T,{className:"w-4 h-4"})}),(0,t.jsx)(a.Button,{variant:"ghost",size:"sm",onClick:()=>Z(e.id),className:"hover:bg-red-500/10 hover:text-red-600",children:(0,t.jsx)(k.Trash2,{className:"w-4 h-4"})})]})})]},e.id)})})]})})]})}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsxs)(s.Card,{className:"p-6 bg-card border-2 border-border hover:border-primary/20 transition-colors",children:[(0,t.jsx)("div",{className:"text-2xl font-display font-bold text-foreground mb-1",children:"48.5 km"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Distance Today"})]}),(0,t.jsxs)(s.Card,{className:"p-6 bg-card border-2 border-border hover:border-primary/20 transition-colors",children:[(0,t.jsxs)("div",{className:"text-2xl font-display font-bold text-foreground mb-1",children:[G.toFixed(1)," kg"]}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Waste Transported"})]}),(0,t.jsxs)(s.Card,{className:"p-6 bg-card border-2 border-border hover:border-primary/20 transition-colors",children:[(0,t.jsx)("div",{className:"text-2xl font-display font-bold text-foreground mb-1",children:"8"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Active Partners"})]}),(0,t.jsxs)(s.Card,{className:"p-6 bg-card border-2 border-border hover:border-primary/20 transition-colors",children:[(0,t.jsx)("div",{className:"text-2xl font-display font-bold text-foreground mb-1",children:"98%"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"On-Time Delivery Rate"})]})]})]})}),(0,t.jsx)(c.Dialog,{open:D,onOpenChange:E,children:(0,t.jsxs)(c.DialogContent,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(c.DialogHeader,{children:[(0,t.jsx)(c.DialogTitle,{children:"Schedule Transportation"}),(0,t.jsx)(c.DialogDescription,{children:"Select an approved pickup request and schedule transportation"})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[!C&&0===n.length&&(0,t.jsxs)("div",{className:"flex items-start gap-3 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,t.jsx)(S.AlertTriangle,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-yellow-800",children:"No Approved Pickups"}),(0,t.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"There are no approved pickup requests available. You can still create transportation manually using Admin Override below."})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"pickupSelect",children:"Select Approved Pickup Request *"}),(0,t.jsxs)(h.Select,{value:U,onValueChange:e=>{if($(e),"admin-override"===e){W(!0),B(e=>({...e,requesterId:"",wasteType:"",quantity:"",requesterName:""}));return}W(!1);let t=n.find(t=>t.id===e);t&&B(e=>({...e,requesterId:t.id,wasteType:t.wasteType||t.itemName,quantity:String(t.quantity),requesterName:t.requesterName}))},disabled:C,children:[(0,t.jsx)(h.SelectTrigger,{id:"pickupSelect",children:(0,t.jsx)(h.SelectValue,{placeholder:C?"Loading...":"Select a pickup request"})}),(0,t.jsxs)(h.SelectContent,{children:[n.map(e=>(0,t.jsx)(h.SelectItem,{value:e.id,children:(0,t.jsxs)("span",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-medium",children:e.requesterName}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.quantity," kg ",e.wasteType," • ","charity"===e.requesterType?"Charity":"Farmer"]})]})},e.id)),(0,t.jsx)(h.SelectItem,{value:"admin-override",className:"border-t mt-2 pt-2",children:(0,t.jsxs)("span",{className:"flex items-center gap-2 text-yellow-600",children:[(0,t.jsx)(S.AlertTriangle,{className:"w-4 h-4"}),"Admin Override (Manual Entry)"]})})]})]})]}),U&&"admin-override"!==U&&(0,t.jsx)(s.Card,{className:"p-4 bg-muted/50",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Requester:"}),(0,t.jsx)("p",{className:"font-medium",children:z.requesterName})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Type:"}),(0,t.jsx)("p",{className:"font-medium",children:z.wasteType})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Quantity:"}),(0,t.jsxs)("p",{className:"font-medium",children:[z.quantity," kg"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Request ID:"}),(0,t.jsx)("p",{className:"font-medium text-xs",children:U})]})]})}),F&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,t.jsx)("p",{className:"text-sm text-yellow-700",children:"⚠️ Admin Override Mode: Enter pickup details manually"})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"requesterId",children:"Pickup Request ID *"}),(0,t.jsx)(u.Input,{id:"requesterId",placeholder:"Enter pickup request ID",value:z.requesterId,onChange:e=>B({...z,requesterId:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"wasteType",children:"Waste Type *"}),(0,t.jsx)(u.Input,{id:"wasteType",placeholder:"e.g., Coffee Grounds",value:z.wasteType,onChange:e=>B({...z,wasteType:e.target.value}),required:!0})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"quantity",children:"Quantity (kg) *"}),(0,t.jsx)(u.Input,{id:"quantity",type:"number",step:"0.1",min:"0",placeholder:"e.g., 15.5",value:z.quantity,onChange:e=>B({...z,quantity:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"requesterName",children:"Requester Name *"}),(0,t.jsx)(u.Input,{id:"requesterName",placeholder:"e.g., Hope Charity",value:z.requesterName,onChange:e=>B({...z,requesterName:e.target.value}),required:!0})]})]})]}),(0,t.jsxs)("div",{className:"border-t pt-4",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Transportation Schedule"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"pickupMethod",children:"Pickup Method *"}),(0,t.jsxs)(h.Select,{value:z.pickupMethod,onValueChange:e=>B({...z,pickupMethod:e}),children:[(0,t.jsx)(h.SelectTrigger,{id:"pickupMethod",children:(0,t.jsx)(h.SelectValue,{})}),(0,t.jsxs)(h.SelectContent,{children:[(0,t.jsx)(h.SelectItem,{value:"staff",children:"Café staff"}),(0,t.jsx)(h.SelectItem,{value:"courier",children:"External courier (Grab / Lalamove)"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2 mt-4",children:[(0,t.jsx)(m.Label,{htmlFor:"assignedTo",children:"Driver / Staff Name *"}),(0,t.jsx)(u.Input,{id:"assignedTo",placeholder:"staff"===z.pickupMethod?"Staff member name":"Courier name",value:z.assignedTo,onChange:e=>B({...z,assignedTo:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2 mt-4",children:[(0,t.jsx)(m.Label,{htmlFor:"pickupDate",children:"Pickup Date *"}),(0,t.jsx)(u.Input,{id:"pickupDate",type:"date",value:z.pickupDate,onChange:e=>B({...z,pickupDate:e.target.value}),min:new Date().toISOString().split("T")[0],required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{children:"Pickup Time From *"}),(0,t.jsx)(f,{value:z.pickupWindowFrom||"12:00",onChange:e=>B({...z,pickupWindowFrom:e})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{children:"Pickup Time To *"}),(0,t.jsx)(f,{value:z.pickupWindowTo||"12:00",onChange:e=>B({...z,pickupWindowTo:e})})]})]}),(0,t.jsxs)("div",{className:"space-y-2 mt-4",children:[(0,t.jsx)(m.Label,{htmlFor:"notes",children:"Notes (Optional)"}),(0,t.jsx)(p.Textarea,{id:"notes",placeholder:"Additional notes or instructions...",value:z.notes,onChange:e=>B({...z,notes:e.target.value}),rows:2})]})]})]}),(0,t.jsxs)(c.DialogFooter,{children:[(0,t.jsx)(a.Button,{variant:"outline",onClick:()=>{B({requesterId:"",wasteType:"",quantity:"",requesterName:"",pickupMethod:"staff",assignedTo:"",pickupDate:"",pickupWindowFrom:"",pickupWindowTo:"",status:"scheduled",notes:""}),$(""),W(!1),E(!1)},children:"Cancel"}),(0,t.jsxs)(a.Button,{onClick:Y,className:"bg-primary hover:bg-primary/90",disabled:!U&&!F,children:[(0,t.jsx)(v.Truck,{className:"w-4 h-4 mr-2"}),"Schedule Transportation"]})]})]})}),(0,t.jsx)(c.Dialog,{open:L,onOpenChange:A,children:(0,t.jsxs)(c.DialogContent,{className:"sm:max-w-[400px]",children:[(0,t.jsxs)(c.DialogHeader,{children:[(0,t.jsx)(c.DialogTitle,{children:"Update Status"}),(0,t.jsx)(c.DialogDescription,{children:"Update the status of this transportation record"})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{htmlFor:"editStatus",children:"Status *"}),(0,t.jsxs)(h.Select,{value:M,onValueChange:e=>O(e),children:[(0,t.jsx)(h.SelectTrigger,{id:"editStatus",children:(0,t.jsx)(h.SelectValue,{})}),(0,t.jsxs)(h.SelectContent,{children:[(0,t.jsx)(h.SelectItem,{value:"SCHEDULED",children:"Scheduled"}),(0,t.jsx)(h.SelectItem,{value:"IN_TRANSIT",children:"In Transit"}),(0,t.jsx)(h.SelectItem,{value:"COMPLETED",children:"Completed"}),(0,t.jsx)(h.SelectItem,{value:"CANCELLED",children:"Cancelled"})]})]})]}),P&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Requester ID:"})," ",P.formattedRequesterId||P.businessName?`${P.businessName}-${(P.requesterId||P.id).substring(0,6).toUpperCase()}`:P.requesterId||P.id]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Destination:"})," ",P.destination||"Unknown"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Current Status:"})," ",P.status]})]})]}),(0,t.jsxs)(c.DialogFooter,{children:[(0,t.jsx)(a.Button,{variant:"outline",onClick:()=>{A(!1),R(null)},children:"Cancel"}),(0,t.jsxs)(a.Button,{onClick:ee,className:"bg-primary hover:bg-primary/90",children:[(0,t.jsx)(j,{className:"w-4 h-4 mr-2"}),"Update Status"]})]})]})})]})},["staff"]);e.s(["default",0,I],90840)}]);